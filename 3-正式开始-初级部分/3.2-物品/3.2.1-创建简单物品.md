# 创建简单物品

## 创建物品的步骤

创建物品主要分三步：

* 创建物品的类（可选）
* 实例化与注册物品
* 物品模型与材质

## 创建物品之前

在阅读之前，建议读者先翻看一下`net.minecraft.item`包，顺便看看`net.minecraft.item.Items`。如果读者看不懂，也没有关系，稍后就会讲到。

我们可以看到，里面所有的物品都直接或间接地**继承了`Item`类**。而且有些物品读者只能在`Items`里看到，**它们都是直接`new Item(...)`的**。其次，读者或许会发现，那些只能在`Items`里看到的物品，**通常都比较简单**，例如铁锭、木棍等。

既然我们的标题是『创建简单物品』，那读者应该知道我们会以什么方式创建了。

## 开始创建简单物品

首先，我们先在`com.github.vvvbbbcz.modderguide`下新建一个包`item`。  
**建议：Mod的包结构最好按照Minecraft的包结构创建，这样可以增强Mod源代码的可读性！**

然后在`item`下新建类`Items`。**建议：在前面添加Mod的缩写，以避免和`net.minecraft.item.Items`重复，方便以后的开发。*因此，我改成了`MGItems`。***

创建物品有两种方法，这两种方法主要是**注册方式**的区别。**此处使用的是第一种，较推荐使用的。若想了解第二种，请[参阅Forge官方文档](https://mcforge.readthedocs.io/en/1.15.x/concepts/registries/#register-events)。**

首先，在`MGItems`新建一个**常量**，用于注册，代码如下：

```java
public static final DeferredRegister<Item> ITEMS = new DeferredRegister<>(ForgeRegistries.ITEMS, ModderGuide.MODID);
```

这里没有什么好讲的，读者自己体会。

然后，再新建另一个**常量**，这是物品的实例。**为了读者阅读方便，这里的代码不是最简形式，请读者运用lambda语句的知识自行化简！**

```java
public static final RegistryObject<Item> TEST_ITEM = ITEMS.register("test_item", () -> {
	return new Item(new Item.Properties().group(ItemGroup.MISC));
});
```

首先是`ITEMS.register(...)`，这是`DeferredRegister`用于注册实例的方法，第一个参数是物品ID，读者应该懂，**注意：物品、方块等的ID用小写下划线**。第二个参数是一个`Supplier<Item>`，这显然不是`Item`，因此我们用了**lambda**语句，返回一个`Item`实例。

其次是`new Item(new Item.Properties().group(ItemGroup.MISC))`，`new Item()`读者应该懂，但参数里的`new Item.Properties()`是什么呢？它提供了很多方法，如`food()`、`maxStackSize()`、`group()`等，用于规定这个物品**最基本的属性**。如所属的创造模式物品栏、食物属性、工具属性等，这里的`.group(ItemGroup.MISC)`表示这个物品在创造模式下可以在“杂项”物品栏里找到，其余的读者可以自己体会。

读到这里，读者应该知道了，我们这样不仅创建了物品的实例，还同时注册了物品。**但实际上这个物品并没有被注册，因为Forge发现不了这段代码。**因此，我们只需要在主类的构造函数中加入如下语句即可：

```java
MGItems.ITEMS.register(FMLJavaModLoadingContext.get().getModEventBus()); // DeferredRegister会自动监听相应的事件，在相应事件发生时进行注册
```

**注意：这里的ITEMS.register()与前面的不是同一个方法！**

主类的构造方法现在就变成了这样：

**`src/main/java/com/github/vvvbbbcz/modderguide/ModderGuide.java（部分）`**：

```java
public ModderGuide() {
	MGItems.ITEMS.register(FMLJavaModLoadingContext.get().getModEventBus());

	FMLJavaModLoadingContext.get().getModEventBus().addListener(this::setup);
	FMLJavaModLoadingContext.get().getModEventBus().addListener(this::enqueueIMC);
	FMLJavaModLoadingContext.get().getModEventBus().addListener(this::processIMC);
	FMLJavaModLoadingContext.get().getModEventBus().addListener(this::doClientStuff);
	FMLJavaModLoadingContext.get().getModEventBus().addListener(this::onServerStarting);

	MinecraftForge.EVENT_BUS.register(this);
}
```

### 物品实例使用的注意事项 

**但读者或许会发现，我们物品的实例并不是一个`Item`，而是一个`RegistryObject`，那我们如何获取`Item`形式的物品实例呢？**

`RegistryObject`提供了一个`get()`方法，在需要这个物品的实例的时候，只需要`MGItems.TEST_ITEM.get()`即可。**但注意：在物品完成注册之前，get()方法只会返回null，在不合适的时机调用会引发空指针异常！**有关解决空指针异常的问题将在**3.4章节**讲到。

## 打开游戏测试

至此，我们的物品就创建完毕了，打开游戏看看吧！

如果读者指定了`ItemGroup`，则物品可以在对应的物品栏找到。如果读者未指定，则可以输入`/give Dev <modid>:<item_id>`获取。

目前这个物品的名字仅仅是`item.<modid>.<item_id>`，材质仅仅是紫黑块，这在**3.5章节**与**3.1.2章节**会讲到。

但我们创建了我们自己的物品，不是吗？